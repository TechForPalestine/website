---
import Layout from "../../layouts/Layout.astro";
import Signatories from "../../components/Signatories.tsx";
import "../../styles/base.css";
---

<Layout title="E4P Pledge">
  
  <main>
    <div class="relative h-96 overflow-hidden">
      <img 
        src="/images/e4p-pledge-hero.jpg" 
        alt="E4P Pledge Hero" 
        class="absolute inset-0 w-full h-full object-cover"
      />
      <div class="absolute inset-0 bg-black bg-opacity-40 flex items-center justify-center">
        <div class="text-center text-white w-full">
          <h1 class="text-7xl font-bold tracking-wide bg-black bg-opacity-40 py-6">PLEDGE</h1>
        </div>
      </div>
    </div>

    <div class="container mx-auto px-4 py-16 max-w-4xl">
      <div class="mb-12">
        <p class="text-red-600 font-semibold">SIGN NOW</p>
        <h2 class="text-6xl font-extrabold my-4 text-gray-900">OUR PLEDGE</h2>
        <div class="w-10 h-1 bg-red-600 mb-8"></div>
        <div class="prose prose-lg max-w-none text-gray-500 space-y-6">
          <p>
           We, entrepreneurs, founders, and CEOs, as witnesses of the genocide in Gaza and the 77-year long colonization and occupation of Palestine, are signing this open letter in order to pledge our support for the Palestinian struggle for justice, equality and liberation and to boycott Israeli businesses and all businesses who are complicit in perpetuating the Israeli colonial system of oppression and apartheid in Palestine.
          </p>
          
          <p>
          The private sector, and especially the tech and startup industry, has historically played a very important role in legitimizing the state of Israel and deepening the ongoing dispossession of Palestinians. Now is the time for private businesses to take a strong stance against the current genocide in Gaza, and against the colonization of Palestine.
          </p>
          
          <p>
           We assert that all companies, no matter where they are based, can make an impact by adopting this position across their activities: hiring, supply chain, trade relations, raising capital, and more.
          </p>
          <p>Therefore <span class="text-gray-700 font-extrabold">we pledge to steer our companiesâ€™ hiring policies, operations, delivery of goods, provision of services, fundraising, and PR activities in order to support Palestine and Palestinians in their fight for self-determination and ownership of the land despite military, political, and economic efforts to displace and eliminate them. This may include:</span></p>
          <ul class="list-disc pl-6 space-y-2 marker:text-red-600">
            <li>Hiring Palestinian talent, donating to Palestinian causes, incorporating Palestinian suppliers in our supply chains, and raising money from investors who support the Palestinian cause.</li>
            <li>Carrying out strategic boycotts of Israeli and other businesses, entities and individuals who support Zionism and are complicit in the current genocide and the ongoing colonization of Palestine, to the extent permitted by law.</li>
          </ul>
          <p>In making this pledge, we reject any kind of discrimination on the basis of ethnicity, race, or religion, including antisemitism and islamophobia. We stand against Zionism as an ideology and we promote values such as democracy, equality, self-determination and justice.</p>
          
          <p>Through this pledge, we join the wider BDS movement and we aim to exert pressure on Israel and its economy, following the example of successful international campaigns such as the anti-apartheid movement in the case of South Africa.</p>

          <p>We call on entrepreneurs globally to sign this letter and to join the movement for a free Palestine.</p>
        </div>
      </div>

      <div class="bg-gray-50 rounded-lg">
        <p class="text-red-600 font-semibold">SIGN NOW</p>
        <h3 class="text-6xl font-extrabold my-4 text-gray-900">SIGN NOW</h3>
        <div class="w-10 h-1 bg-red-600 mb-8"></div>
        
        <div id="form-message" class="hidden p-4 rounded-md mb-4"></div>
        
        <form class="space-y-4" id="pledge-form" method="POST">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="Name" class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"
              />
            </div>
            <div>
              <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"
              />
            </div>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="company" class="block text-sm font-medium text-gray-700 mb-1">Your Company *</label>
              <input
                type="text"
                id="company"
                name="company"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"
              />
            </div>
            <div>
              <label for="position" class="block text-sm font-medium text-gray-700 mb-1">Your position *</label>
              <input 
                type="text"
                id="position"
                name="position"
                required
                class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"
              />
            </div>
          </div>
          
          <div>
            <label for="linkedin" class="block text-sm font-medium text-gray-700 mb-1">LinkedIn URL *</label>
            <input 
              type="url"
              id="linkedin"
              name="linkedin"
              placeholder="https://linkedin.com/in/your-profile"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500"
            />
          </div>
          
          <div class="flex items-start space-x-3">
            <input
              type="checkbox"
              id="agreement"
              name="agreement"
              required
              class="mt-1 h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"
            />
            <label for="agreement" class="text-sm text-gray-700">
              I agree that my submitted data will be processed and stored by Entrepreneurs for Palestine and that my name, position and company will be listed under the Signatories section of this pledge.
            </label>
          </div>
          
          <div class="pt-4">
            <button 
              type="submit" 
              id="submit-button"
              class="w-full md:w-auto px-8 py-3 bg-red-600 text-white font-semibold rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
            >
              <span id="submit-text">Sign pledge</span>
            </button>
          </div>
        </form>
      </div>

      <div class="mt-16">
        <p class="text-red-600 font-semibold">FULL LIST</p>
        <h3 class="text-6xl font-extrabold my-4 text-gray-900">SIGNATORIES</h3>
        <div class="w-10 h-1 bg-red-600 mb-8"></div>
        <Signatories client:only="react" />
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('pledge-form') as HTMLFormElement | null;
      const messageDiv = document.getElementById('form-message') as HTMLDivElement | null;
      const submitButton = document.getElementById('submit-button') as HTMLButtonElement | null;
      const submitText = document.getElementById('submit-text') as HTMLSpanElement | null;

      if (!form || !messageDiv || !submitButton || !submitText) {
        console.error('Required form elements not found');
        return;
      }

      function showMessage(message: string, isError: boolean = false): void {
        if (!messageDiv) return;
        messageDiv.textContent = message;
        messageDiv.className = `p-4 rounded-md mb-4 ${isError ? 'bg-red-50 text-red-800 border border-red-200' : 'bg-green-50 text-green-800 border border-green-200'}`;
        messageDiv.classList.remove('hidden');
        messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }

      function setLoading(loading: boolean): void {
        if (!submitButton || !submitText) return;
        submitButton.disabled = loading;
        submitText.textContent = loading ? 'Signing...' : 'Sign pledge';
      }

      form.addEventListener('submit', async function(e: Event) {
        e.preventDefault();
        
        if (!form || !messageDiv) return;
        
        setLoading(true);
        messageDiv.classList.add('hidden');

        try {
          const formData = new FormData(form);
          
          const response = await fetch('/api/e4p-pledge-sign', {
            method: 'POST',
            body: formData
          });

          const result = await response.json();

          if (response.ok) {
            showMessage('Thank you for signing the pledge. We will include you in the list of signatories once your submission has been verified.');
            form.reset();
          } else {
            showMessage(result.error || 'Failed to submit pledge. Please try again.', true);
          }
        } catch (error) {
          console.error('Error submitting pledge:', error);
          showMessage('Network error. Please check your connection and try again.', true);
        } finally {
          setLoading(false);
        }
      });
    });
  </script>

</Layout>